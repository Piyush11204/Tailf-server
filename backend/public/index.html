<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Tailf Server - Real-time Log Monitor</title>
  <style>
    body { font-family: 'Segoe UI', Arial, sans-serif; background: #fafbfc; color: #222; margin: 0; padding: 0 0 40px 0; }
    h1 { margin: 24px 0 8px 0; text-align: center; font-size: 2em; }
    p { text-align: center; margin-bottom: 24px; color: #555; }
    section { max-width: 600px; margin: 18px auto; padding: 12px 18px; background: #fff; border-radius: 7px; box-shadow: 0 1px 6px #0001; }
    h3 { margin-top: 0; font-size: 1.1em; color: #2d5be3; }
    button { margin: 0 4px 0 0; padding: 5px 14px; border: 1px solid #d0d0d0; border-radius: 4px; background: #f4f6fa; color: #222; cursor: pointer; font-size: 1em; }
    button:disabled { opacity: 0.6; cursor: not-allowed; }
    input[type="number"] { margin: 0 6px 0 0; padding: 4px 8px; border-radius: 4px; border: 1px solid #d0d0d0; font-size: 1em; }
    #status { max-width: 600px; margin: 12px auto; text-align: center; color: #fff; background: #2d5be3; border-radius: 4px; padding: 6px 0; min-height: 18px; }
    pre#terminal { max-width: 600px; margin: 18px auto 0 auto; background: #181818; color: #b8ffb8; border-radius: 7px; padding: 14px; min-height: 120px; font-size: 1em; overflow-x: auto; }
  </style>
</head>






  //done
<body>

  <section>
    <h3>Tail Controls</h3>
    <span style="font-weight:bold;">File:</span> <span style="color:#2d5be3;">sample.log</span>
    <input type="number" id="linesInput" value="10" min="1" max="100" placeholder="Lines to show">
    <button id="startBtn" onclick="startTail()">Start Tail</button>
    <button id="stopBtn" onclick="stopTail()" disabled>Stop Tail</button>
    <button onclick="clearTerminal()">Clear</button>
  </section>

  <div id="status"></div>

  <pre id="terminal">Ready to tail files...</pre>

  <script>
    const ws = new WebSocket(`ws://${location.host}`);
    const terminal = document.getElementById('terminal');
    const startBtn = document.getElementById('startBtn');
    const stopBtn = document.getElementById('stopBtn');
    const status = document.getElementById('status');
    const linesInput = document.getElementById('linesInput');

    let currentFile = null;

    ws.onopen = () => {
      showStatus('Connected to server', 'success');
    };

    ws.onclose = () => {
      showStatus('Disconnected from server', 'error');
    };

    ws.onerror = (err) => {
      showStatus('WebSocket error', 'error');
    };

    ws.onmessage = (event) => {
      const data = JSON.parse(event.data);

      switch (data.type) {
        case 'initial-lines':
          clearTerminal();
          data.lines.forEach(line => addLine(line));
          scrollToBottom();
          break;

        case 'new-line':
          addLine(data.line, true);
          scrollToBottom();
          break;

        case 'error':
          showStatus(`Error: ${data.message}`, 'error');
          break;

        case 'tail-stopped':
          showStatus(`Stopped monitoring sample.log`, 'success');
          stopTail();
          break;
      }
    };

    function addLine(text, isNew = false) {
      terminal.textContent += `${new Date().toISOString()} | ${text}\n`;
      const lines = terminal.textContent.split('\n');
      if (lines.length > 1000) {
        terminal.textContent = lines.slice(-1000).join('\n');
      }
    }

    function scrollToBottom() {
      terminal.scrollTop = terminal.scrollHeight;
    }

    function clearTerminal() {
      terminal.textContent = '';
    }

    function showStatus(message, type) {
      status.textContent = message;
      status.style.background = type === 'error' ? '#e32d2d' : '#2d5be3';
      setTimeout(() => (status.textContent = ''), 3500);
    }

    function startTail() {
      const filename = "sample.log";
      const lines = 10;

      currentFile = filename;

      const message = {
        type: 'start-tail',
        filename,
        lines
      };

      ws.send(JSON.stringify(message));

      startBtn.disabled = true;
      stopBtn.disabled = false;

      showStatus(`Started monitoring ${filename}`, 'success');
    }

    function stopTail() {
      if (currentFile) {
        const message = {
          type: 'stop-tail',
          filename: currentFile
        };
        ws.send(JSON.stringify(message));
      }

      currentFile = null;

      startBtn.disabled = false;
      stopBtn.disabled = true;
    }

    refreshFiles();
  </script>
</body>
</html>
